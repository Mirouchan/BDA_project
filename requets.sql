INSERT INTO departements (nom) VALUES
('Informatique'),
('Mathématiques'),
('Biologie'),
('Physique'),
('Chimie'),
('Médecine'),
('Agronomie');

INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Informatique', 1, 6),
('Master Informatique', 1, 8),
('Licence Génie Logiciel', 1, 7),
('Master Génie Logiciel', 1, 9),
('Licence Réseaux et Sécurité', 1, 6),
('Master Réseaux et Sécurité', 1, 8),
('Licence Intelligence Artificielle', 1, 6),
('Master Intelligence Artificielle', 1, 8),
('Licence Data Science', 1, 6),
('Master Data Science', 1, 8),
('Licence Cybersécurité', 1, 6),
('Master Cybersécurité', 1, 8),
('Licence Informatique Industrielle', 1, 6),
('Master Informatique Industrielle', 1, 8),
('Licence Développement Web', 1, 6),
('Master Développement Web', 1, 8),
('Licence Mobile et Applications', 1, 6),
('Master Mobile et Applications', 1, 8),
('Licence Cloud Computing', 1, 6),
('Master Cloud Computing', 1, 8),
('Licence Systèmes Embarqués', 1, 6),
('Master Systèmes Embarqués', 1, 8),
('Licence Algorithmique et Data Structures', 1, 6),
('Master Algorithmique et Data Structures', 1, 8),
('Licence Informatique Graphique', 1, 6),
('Master Informatique Graphique', 1, 8),
('Licence Informatique Quantique', 1, 6),
('Master Informatique Quantique', 1, 8),
('Licence Robotique', 1, 6),
('Master Robotique', 1, 8),
('Licence Informatique Mobile', 1, 6),
('Master Informatique Mobile', 1, 8),
('Licence Informatique Financière', 1, 6),
('Master Informatique Financière', 1, 8),
('Licence Systèmes et Réseaux', 1, 6),
('Master Systèmes et Réseaux', 1, 8);

INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Mathématiques', 2, 6),
('Master Mathématiques Appliquées', 2, 8),
('Licence Statistiques', 2, 6),
('Master Statistiques et Data', 2, 8),
('Licence Mathématiques Fondamentales', 2, 6),
('Master Mathématiques Fondamentales', 2, 8),
('Licence Analyse et Algèbre', 2, 6),
('Master Analyse et Algèbre', 2, 8),
('Licence Probabilités et Statistiques', 2, 6),
('Master Probabilités et Statistiques', 2, 8),
('Licence Mathématiques pour la Finance', 2, 6),
('Master Mathématiques pour la Finance', 2, 8),
('Licence Informatique Mathématique', 2, 6),
('Master Informatique Mathématique', 2, 8),
('Licence Data Analytics', 2, 6),
('Master Data Analytics', 2, 8),
('Licence Modélisation Mathématique', 2, 6),
('Master Modélisation Mathématique', 2, 8),
('Licence Optimisation', 2, 6),
('Master Optimisation', 2, 8),
('Licence Mathématiques et Physique', 2, 6),
('Master Mathématiques et Physique', 2, 8),
('Licence Mathématiques et Informatique', 2, 6),
('Master Mathématiques et Informatique', 2, 8),
('Licence Mathématiques Appliquées à l’Économie', 2, 6),
('Master Mathématiques Appliquées à l’Économie', 2, 8),
('Licence Mathématiques et Biostatistique', 2, 6),
('Master Mathématiques et Biostatistique', 2, 8),
('Licence Mathématiques pour Data Science', 2, 6),
('Master Mathématiques pour Data Science', 2, 8),
('Licence Statistiques Appliquées', 2, 6),
('Master Statistiques Appliquées', 2, 8),
('Licence Mathématiques Computationnelles', 2, 6),
('Master Mathématiques Computationnelles', 2, 8),
('Licence Mathématiques et Intelligence Artificielle', 2, 6),
('Master Mathématiques et Intelligence Artificielle', 2, 8);

INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Biologie', 3, 6),
('Master Biologie Moléculaire', 3, 8),
('Licence Biochimie', 3, 6),
('Master Biochimie', 3, 8),
('Licence Biotechnologie', 3, 6),
('Master Biotechnologie', 3, 8),
('Licence Génétique', 3, 6),
('Master Génétique', 3, 8),
('Licence Microbiologie', 3, 6),
('Master Microbiologie', 3, 8),
('Licence Physiologie', 3, 6),
('Master Physiologie', 3, 8),
('Licence Écologie', 3, 6),
('Master Écologie', 3, 8),
('Licence Biologie Marine', 3, 6),
('Master Biologie Marine', 3, 8),
('Licence Immunologie', 3, 6),
('Master Immunologie', 3, 8),
('Licence Biologie Cellulaire', 3, 6),
('Master Biologie Cellulaire', 3, 8),
('Licence Biologie Structurale', 3, 6),
('Master Biologie Structurale', 3, 8),
('Licence Biologie Environnementale', 3, 6),
('Master Biologie Environnementale', 3, 8),
('Licence Biologie Théorique', 3, 6),
('Master Biologie Théorique', 3, 8),
('Licence Biologie Appliquée', 3, 6),
('Master Biologie Appliquée', 3, 8);

INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Physique', 4, 6),
('Master Physique Fondamentale', 4, 8),
('Licence Physique Appliquée', 4, 6),
('Master Physique Appliquée', 4, 8),
('Licence Optique', 4, 6),
('Master Optique', 4, 8),
('Licence Mécanique', 4, 6),
('Master Mécanique', 4, 8),
('Licence Électromagnétisme', 4, 6),
('Master Électromagnétisme', 4, 8),
('Licence Physique Théorique', 4, 6),
('Master Physique Théorique', 4, 8),
('Licence Physique des Particules', 4, 6),
('Master Physique des Particules', 4, 8),
('Licence Physique Nucléaire', 4, 6),
('Master Physique Nucléaire', 4, 8),
('Licence Astrophysique', 4, 6),
('Master Astrophysique', 4, 8),
('Licence Physique Informatique', 4, 6),
('Master Physique Informatique', 4, 8),
('Licence Physique Appliquée à l’Industrie', 4, 6),
('Master Physique Appliquée à l’Industrie', 4, 8),
('Licence Physique et Électronique', 4, 6),
('Master Physique et Électronique', 4, 8),
('Licence Physique et Informatique', 4, 6),
('Master Physique et Informatique', 4, 8),
('Licence Physique Nucléaire Avancée', 4, 6),
('Master Physique Nucléaire Avancée', 4, 8),
('Licence Astrophysique Appliquée', 4, 6),
('Master Astrophysique Appliquée', 4, 8);


INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Chimie', 5, 6),
('Master Chimie Organique', 5, 8),
('Master Chimie Industrielle', 5, 8),
('Licence Chimie Analytique', 5, 6),
('Master Chimie Analytique', 5, 8),
('Licence Chimie Physique', 5, 6),
('Master Chimie Physique', 5, 8),
('Licence Chimie Biologique', 5, 6),
('Master Chimie Biologique', 5, 8),
('Licence Chimie Théorique', 5, 6),
('Master Chimie Théorique', 5, 8),
('Licence Chimie des Matériaux', 5, 6),
('Master Chimie des Matériaux', 5, 8),
('Licence Chimie Industrielle Avancée', 5, 6),
('Master Chimie Industrielle Avancée', 5, 8),
('Licence Chimie et Environnement', 5, 6),
('Master Chimie et Environnement', 5, 8),
('Licence Chimie pour la Santé', 5, 6),
('Master Chimie pour la Santé', 5, 8),
('Licence Chimie Alimentaire', 5, 6),
('Master Chimie Alimentaire', 5, 8),
('Licence Chimie et Biotechnologie', 5, 6),
('Master Chimie et Biotechnologie', 5, 8),
('Licence Chimie Théorique Avancée', 5, 6),
('Master Chimie Théorique Avancée', 5, 8),
('Licence Chimie Analytique Avancée', 5, 6),
('Master Chimie Analytique Avancée', 5, 8),
('Licence Chimie Physique Avancée', 5, 6),
('Master Chimie Physique Avancée', 5, 8);

INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Médecine', 6, 6),
('Master Médecine Générale', 6, 8),
('Licence Chirurgie', 6, 6),
('Master Chirurgie', 6, 8),
('Licence Pharmacie', 6, 6),
('Master Pharmacie', 6, 8),
('Licence Médecine Dentaire', 6, 6),
('Master Médecine Dentaire', 6, 8),
('Licence Biologie Médicale', 6, 6),
('Master Biologie Médicale', 6, 8),
('Licence Médecine Vétérinaire', 6, 6),
('Master Médecine Vétérinaire', 6, 8),
('Licence Santé Publique', 6, 6),
('Master Santé Publique', 6, 8),
('Licence Nutrition', 6, 6),
('Master Nutrition', 6, 8),
('Licence Kinésithérapie', 6, 6),
('Master Kinésithérapie', 6, 8),
('Licence Psychologie Médicale', 6, 6),
('Licence Psychologie Médicale humains', 6, 7),
('Master Psychologie Médicale', 6, 8);

INSERT INTO formations (nom, departement_id, nbr_module) VALUES
('Licence Agronomie', 7, 6),
('Master Agronomie', 7, 8),
('Licence Agriculture', 7, 6),
('Master Agriculture', 7, 8),
('Licence Génie Rural', 7, 6),
('Master Génie Rural', 7, 8),
('Licence Horticulture', 7, 6),
('Master Horticulture', 7, 8),
('Licence Agriculture Durable', 7, 6),
('Master Agriculture Durable', 7, 8),
('Licence Agroalimentaire', 7, 6),
('Master Agroalimentaire', 7, 8),
('Licence Agroécologie', 7, 6),
('Master Agroécologie', 7, 8),
('Licence Science du Sol', 7, 6),
('Master Science du Sol', 7, 8),
('Licence Foresterie', 7, 6),
('Master Foresterie', 7, 8),
('Licence Gestion des Ressources Naturelles', 7, 6),
('Master Gestion des Ressources Naturelles', 7, 8);

SELECT COUNT(*) FROM formations;


INSERT INTO etudiants (nom, prenom, formation_id, promo)
SELECT
  ELT(1 + FLOOR(RAND()*186), 'Benali','Boudjemaa','Kaci','Hamdi','Toumi','Saidi','Mansouri',
    'Bouaziz','Cherif','Amrani','Meziane','Rahmani','AitAhmed','Zerrouki',
    'Larbi','Belkacem','Bensaid','Yahiaoui','Haddad','Slimani','Ferhat',
    'Messaoud','Djaffar','Nacer','Tahar','Hocine','Samir','Rachid','Fouad',
    'Kamel','Nadir','Lotfi','Youssef','Reda','Hicham','Mounir','Adel','Amara',
    'Aziz','Said','Farouk','Mokhtar','Khaled','Imad','Rami','Mehdi','Mustapha',
    'Salah','Amine','Mohsen','Tarik','Yassine','Anouar','Fares','Marouane',
    'Hakim','Samy','Idir','Rayan','Omar','Sami','Karim','Ali','Bilal','Othman',
    'Ilyes','Malik','Redouane','Abdel','Aymen','Ismail','Hamza','Adil','Nabil',
    'Tayeb','Younes','Sofiane','Yahia','Yassin','Ahmed','Mohamed','Yacine',
    'Rabah','Lotfi','Hassan','Nacer','Said','Fouzi','Amar','Khalil','Riad',
    'Amin','Farid','Hichem','Kamel','Abdelkader','Samir','Mounir','Abdelhamid',
    'Azzedine','Salah','Karim','MohamedAli','MohamedAmine','OmarFarouk','AliRami',
    'MehdiSamir','YassineHakim','RedaMounir','NadirLotfi','AzizKhaled','ImadTarik',
    'AnisFarouk','MarouaneIdir','TaharRayan','SofianeKarim','AmineYounes','HassanMalik',
    'Ferrah','Medour','Touati','Abdeli','Simohand','Zerrouk',
     'Derias','Ferhaoui','Fennour','Fennouh','Coumichi','Fazouli',
'Zerrifi','Seffroun','Abbasi','Bousoir','Zemmour','Zemouri',
'Amrouche','Arkoub','Bedjbedj','Bouter','Osmani','Rekkas','Merdes','Saidani','Sellami',
'Seghir','Yahiaoui','Lounic','Chergi','Grib','Kohli','Mekiri','Tafat','Ouhibi','Zbour',
'Zimam','Selikh','Oubakouk','Ghouila','Fahdi',
'Zerrouki','Mahrez','Zidan','Amoura','Boulbina','Mandi','HadjMoussa','Maza','Bensabaini',
'Bounedjah','Blaili','Belghali','Aitnouri','Benacer','Boudaoui','Chaibi','Belaid','Kebbal',
'Mandrea','Benbout','Tougai','Atal','Hadjem','Zorgane','Aouar','Bekrar')
AS nom,
  ELT(1 + FLOOR(RAND()*153), 'Ahmed','Mohamed','Yacine','Sofiane','Islam','Amine','Anis','Walid','Nassim',
    'Karim','Imane','Sarah','Lina','Aya','Nour','Fatima','Khadija','Asma','Ines',
    'Meriem','Samira','Nadia','Amina','Yasmine','Leila','Selma','Sofia','Rania',
    'Salima','Djamila','Siham','Farah','Naima','Malika','Souad','Soraya','Rachida',
    'Lamia','Nouria','Nawal','Hanane','Samia','Zineb','Ikram','Meryem','Safia','Houda',
    'Imen','Yousra','Jihane','Kenza','Amel','Samar','Naoual','Chaima','Sana','Hiba',
    'SarahAmel','LeilaNour','YasmineAya','MeriemInes','FatimaLina','ImaneSofia','NadiaRania',
    'AminaSalima','SamiraDjamila','SihamFarah','NaimaMalika','SouadSoraya','RachidaLamia',
    'NouriaNawal','HananeSamia','IkramMeryem','SafiaHouda','ImenYousra','JihaneKenza',
    'AmelSamar','NaoualChaima','SanaHiba','AyaYasmine','LinaSarah','MeryemInes','KhadijaFatima',
'Ilan','Oumaima','Sara','Afaf','Hamza','Heithem','Ouail','Assil','Akram','Basat','Bara','Aous',
'Kousay','Yousr','Yazan','Ghait','Laith','Saith','Afnan','Taim','Badar','Ayoub','Ala','Khaoulat',
'Mouna','Mouni','Samah','Malik','abla','Fayrouz','Hasna','Berkahoum','Nayla','Samara','Zouliha',
'Mimina','Fadia','Nesayem','Rawia','Rabab','Akila','Batoul','Dalal','Fatine','Hafsa','Haifa','Ibtihal',
'Ibtissem','Lamya','Ridwana','Widad','Aicha','Anissa','Dana','Dina','Layal','Azra','Ilham','Khalida',
'Nassira','Nadira','Sawsan','Zaina','Ibrahim','Salem','Salim','Kamel','Faras','Nadir','Nawal') AS prenom,
  (SELECT id FROM formations ORDER BY RAND() LIMIT 1) AS formation_id,
  ELT(1 + FLOOR(RAND()*5), '2020-2021','2021-2022','2022-2023','2023-2024','2024-2025') AS promo
FROM information_schema.tables t1
CROSS JOIN information_schema.tables t2
LIMIT 13000;

 /*  STATISTIQUES ET REQUÊTES – GESTION DES EXAMENS */

/*1. Nombre d’étudiants par module*/
SELECT 
    m.id AS module_id,
    m.responsable_id,
    COUNT(i.id) AS nb_etudiants
FROM modules m
LEFT JOIN inscriptions i ON m.id = i.module_id
GROUP BY m.id
ORDER BY nb_etudiants DESC;


/* 2. Informations de base des examens */
SELECT 
    salle_id,
    date_heure,
    surveillant_principal_id
FROM examens;


/*3. Salles d’examen classées par capacité */
SELECT 
    id,
    nom,
    capacite
FROM lieu_exam
ORDER BY capacite DESC;


/* 4. Jours de session non fériés */
SELECT 
    id,
    date
FROM jours_session
WHERE est_ferie = 0
ORDER BY date;


/* 5. Nombre total d’examens par département*/
SELECT COUNT(*) AS total_examens
FROM examens e
JOIN modules m ON e.module_id = m.id
JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?;


/* 6. Examens validés (VALIDER) par département*/
SELECT COUNT(*) AS examens_valides
FROM examens e
JOIN modules m ON e.module_id = m.id
JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?
  AND e.statu = 'VALIDER';


/* 7. Examens en validation finale*/
SELECT COUNT(*) AS examens_validation_finale
FROM examens e
JOIN modules m ON e.module_id = m.id
JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?
  AND e.statu = 'VALIDATION_FINAL';


/*8. Nombre de conflits par département */
SELECT COUNT(*) AS total_conflits
FROM conflits_edt c
LEFT JOIN examens e1 ON c.examen_id_1 = e1.id
LEFT JOIN modules m ON e1.module_id = m.id
LEFT JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?;


/* 9. Liste des surveillants par département */
SELECT DISTINCT 
    e.surveillant_principal_id
FROM examens e
JOIN modules m ON e.module_id = m.id
JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?;


/*10. Détails des examens par département */
SELECT 
    e.id,
    m.nom AS module,
    j.date AS jour,
    l.nom AS salle,
    e.date_heure,
    e.statu,
    f.nom AS formation
FROM examens e
JOIN modules m ON e.module_id = m.id
JOIN jours_session j ON e.jour_id = j.id
JOIN lieu_exam l ON e.salle_id = l.id
JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?
ORDER BY f.nom, j.date, e.date_heure;


/* 11. Détails des conflits par département*/
SELECT 
    c.*,
    m.nom AS module,
    f.nom AS formation
FROM conflits_edt c
LEFT JOIN examens e1 ON c.examen_id_1 = e1.id
LEFT JOIN modules m ON e1.module_id = m.id
LEFT JOIN formations f ON m.formation_id = f.id
WHERE f.departement_id = ?
ORDER BY f.nom;


/*  12. Vue globale des examens */
SELECT 
    e.id AS examen_id,
    e.statu,
    m.nom AS module,
    j.date AS jour,
    l.nom AS salle,
    e.date_heure
FROM examens e
JOIN modules m ON e.module_id = m.id
JOIN jours_session j ON e.jour_id = j.id
JOIN lieu_exam l ON e.salle_id = l.id
JOIN formations f ON m.formation_id = f.id;


/* 13. Taux d’utilisation des salles */
SELECT 
    COUNT(DISTINCT salle_id) AS salles_utilisees,
    (SELECT COUNT(*) FROM lieu_exam) AS total_salles
FROM examens;


/*14. KPIs examens & conflits par département */
SELECT 
    d.nom AS departement,
    COUNT(DISTINCT e.id) AS total_examens,
    COUNT(DISTINCT c.id) AS total_conflits
FROM departements d
LEFT JOIN formations f ON f.departement_id = d.id
LEFT JOIN modules m ON m.formation_id = f.id
LEFT JOIN examens e ON e.module_id = m.id
LEFT JOIN conflits_edt c 
    ON (c.examen_id_1 = e.id OR c.examen_id_2 = e.id)
   AND c.statut = 'NON_RESOLU'
GROUP BY d.id;


/*15. Nombre de conflits par département*/
SELECT 
    d.nom,
    COUNT(c.id) AS total_conflits
FROM conflits_edt c
LEFT JOIN examens e1 ON c.examen_id_1 = e1.id
LEFT JOIN modules m ON e1.module_id = m.id
LEFT JOIN formations f ON m.formation_id = f.id
LEFT JOIN departements d ON f.departement_id = d.id
GROUP BY d.id;


/* 16. Nombre d’examens par salle*/
SELECT 
    l.nom,
    COUNT(e.id) AS total_examens
FROM lieu_exam l
LEFT JOIN examens e ON l.id = e.salle_id
GROUP BY l.id;


/* 17. Charge de surveillance par surveillant*/
SELECT 
    surveillant_principal_id,
    COUNT(*) AS total_examens
FROM examens
GROUP BY surveillant_principal_id;


/*  18. Conflits non résolus*/
SELECT COUNT(*) AS conflits_non_resolus
FROM conflits_edt
WHERE statut = 'NON_RESOLU';


/* 19. Statistiques globales*/
SELECT COUNT(*) AS total_examens FROM examens;
SELECT COUNT(*) AS total_salles FROM lieu_exam;



